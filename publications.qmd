---
title: "Outputs"
---

```{r}
#| label: setup
#| include: false

library(jsonlite)
library(dplyr)
library(tidyr)
library(DT)
library(glue)
library(stringr)
```

```{r}
#| label: load-data
#| include: false

pub_data <- fromJSON(here::here("_data", "publications.json"))
pubs <- pub_data$publications |>
  as_tibble() |>
  mutate(
    title_link = case_when(
      !is.na(url) & url != "" ~ glue('<a href="{url}" target="_blank">{title}</a>'),
      TRUE ~ title
    ),
    type_clean = str_to_title(str_replace_all(type, "-", " ")),
    year = replace_na(year, 0),
    sotl_label = if_else(is_sotl == TRUE, "SoTL", "Discpline-specific"),
    school_display = replace_na(network_schools, "â€”")
  )
```

Browse and search all `r nrow(pubs)` outputs from network members. Use the dropdown filters and search box below each column header to filter by type, year, or other criteria.

::: {.callout-tip}
## Output Types in This Collection

```{r}
#| label: type-summary
#| echo: false
#| results: asis

type_counts <- pubs |>
  count(type_clean, sort = TRUE) |>
  filter(!is.na(type_clean), type_clean != "")

for (i in seq_len(nrow(type_counts))) {
  cat(glue("- **{type_counts$type_clean[i]}**: {type_counts$n[i]}\n"), sep = "\n")
}
```

:::


```{r}
#| label: pub-table
#| echo: false

pubs |>
  select(
    Title = title_link,
    Year = year,
    School = school_display,
    Journal = journal,
    Type = type_clean,
    Category = sotl_label,
    `Network Authors` = network_authors
  ) |>
  datatable(
    escape = FALSE,
    filter = "top",
    options = list(
      pageLength = 25,
      order = list(list(1, "desc")),
      columnDefs = list(
        list(width = "30%", targets = 0),
        list(width = "6%", targets = 1),
        list(width = "6%", targets = 5),
        list(className = "dt-left", targets = "_all")
      ),
      searchCols = list(
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL,
        NULL
      )
    ),
    rownames = FALSE
  )
```
## Publications by Year

```{r}
#| label: by-year
#| echo: false
#| fig-width: 10
#| fig-height: 5

library(ggplot2)

year_counts <- pubs |>
  filter(year > 0) |>
  count(year) |>
  arrange(year)

ggplot(year_counts, aes(x = year, y = n)) +
geom_col(fill = "#2c3e50") +
  labs(
    x = "Year",
    y = "Number of Publications",
    title = "Publications per Year"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )
```

------------------------------------------------------------------------

*Data sourced from ORCID. Last updated: `r pub_data$last_updated`*
